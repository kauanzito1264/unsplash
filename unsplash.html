<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unsplash Image Search</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for aesthetic grid display */
        .image-grid {
            column-count: 1;
            column-gap: 1rem;
            padding: 1rem;
        }
        .grid-item {
            margin-bottom: 1rem;
            break-inside: avoid;
        }
        .grid-item img {
            width: 100%;
            height: auto;
            display: block;
        }

        /* Responsive Columns (Mobile first) */
        @media (min-width: 640px) {
            .image-grid {
                column-count: 2;
            }
        }
        @media (min-width: 1024px) {
            .image-grid {
                column-count: 3;
            }
        }

        /* Smooth image loading transition */
        .grid-item img {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
            border-radius: 0.5rem; /* rounded corners */
        }
        .grid-item:hover img {
            transform: scale(1.02);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#1F2937', /* Dark Gray */
                        'secondary': '#4B5563', /* Lighter Dark Gray */
                        'accent': '#60A5FA', /* Blue */
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
</head>
<body class="bg-primary text-gray-100 font-sans min-h-screen">
    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="text-center py-8">
            <h1 class="text-4xl font-extrabold text-accent">Unsplash Search Explorer</h1>
            <p class="mt-2 text-secondary-200">Search over 5 million free high-resolution images.</p>
        </header>

        <!-- Search Input Section -->
        <div class="mb-8 flex flex-col md:flex-row gap-4">
            <input type="text" id="search-input" placeholder="Enter search term (e.g., mountains, coffee, nature)"
                   class="flex-grow p-3 border border-secondary bg-secondary-900 rounded-lg focus:ring-accent focus:border-accent text-black placeholder-gray-400 shadow-xl">
            <button id="search-button"
                    class="bg-accent hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg shadow-lg transition duration-300 transform hover:scale-[1.02]">
                Search Images
            </button>
        </div>

        <!-- Message Area for Loading/Errors -->
        <div id="message-area" class="text-center py-4 text-gray-400 italic">
            Start your search!
        </div>

        <!-- Image Results Grid -->
        <div id="results-grid" class="image-grid">
            <!-- Images will be inserted here by JavaScript -->
        </div>

    </div>

    <script>
        // --- CONFIGURATION ---
        // This is the Access Key you provided.
        const UNSPLASH_ACCESS_KEY = "MtkK4v_mNI32_X8zjR_4zZ7DZQXTcnbnsiC3E8HPQrY";
        const API_BASE_URL = "https://api.unsplash.com/search/photos";
        // --- END CONFIGURATION ---

        const searchInput = document.getElementById('search-input');
        const searchButton = document.getElementById('search-button');
        const resultsGrid = document.getElementById('results-grid');
        const messageArea = document.getElementById('message-area');

        /**
         * Clears the current results and displays a status message.
         * @param {string} message - The message to display.
         */
        function showMessage(message) {
            resultsGrid.innerHTML = '';
            messageArea.textContent = message;
            messageArea.classList.remove('hidden');
        }

        /**
         * Handles the search request, including error checking and fetching data.
         */
        async function searchImages() {
            const query = searchInput.value.trim();

            // This check is still useful in case the key is accidentally deleted later.
            if (!UNSPLASH_ACCESS_KEY || UNSPLASH_ACCESS_KEY === "YOUR_UNSPLASH_ACCESS_KEY") {
                showMessage('Error: The Unsplash Access Key is missing from the script.');
                return;
            }

            if (query.length < 2) {
                showMessage('Please enter a search term with at least 2 characters.');
                return;
            }

            showMessage(`Searching for "${query}"...`);
            
            const url = `${API_BASE_URL}?query=${encodeURIComponent(query)}&client_id=${UNSPLASH_ACCESS_KEY}&per_page=30`;

            try {
                const response = await fetch(url);
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    // Attempt to show specific API error message if available
                    const errorMessage = errorData.errors ? errorData.errors.join('; ') : `HTTP error! Status: ${response.status}`;
                    showMessage(`Search Failed: ${errorMessage}. Check your API Key and rate limits.`);
                    console.error('API Response Error:', errorData);
                    return;
                }

                const data = await response.json();
                displayResults(data.results, query);

            } catch (error) {
                showMessage(`An unexpected error occurred. Check your network connection.`);
                console.error('Fetch Error:', error);
            }
        }

        /**
         * Processes the API results and injects them into the DOM.
         * @param {Array} images - Array of image objects from Unsplash.
         * @param {string} query - The original search query.
         */
        function displayResults(images, query) {
            resultsGrid.innerHTML = '';
            messageArea.classList.add('hidden');

            if (images.length === 0) {
                showMessage(`No images found for "${query}". Try a different term.`);
                return;
            }

            images.forEach(photo => {
                const item = document.createElement('div');
                item.className = 'grid-item shadow-xl bg-secondary rounded-lg overflow-hidden';

                const img = document.createElement('img');
                // Use the 'small' URL for the displayed image
                img.src = photo.urls.small;
                img.alt = photo.alt_description || `Image related to ${query}`;
                img.title = `Photo by ${photo.user.name}`;
                
                // Add Unsplash attribution link (required by Unsplash API guidelines)
                const attribution = document.createElement('p');
                attribution.className = 'p-2 text-xs text-gray-400 truncate';
                
                const photographerLink = document.createElement('a');
                photographerLink.href = photo.user.links.html + "?utm_source=Unsplash_Search_Explorer&utm_medium=referral";
                photographerLink.target = "_blank";
                photographerLink.textContent = photo.user.name;
                photographerLink.className = 'hover:text-accent font-medium';

                const unsplashLink = document.createElement('a');
                unsplashLink.href = "https://unsplash.com?utm_source=Unsplash_Search_Explorer&utm_medium=referral";
                unsplashLink.target = "_blank";
                unsplashLink.textContent = "Unsplash";
                unsplashLink.className = 'hover:text-accent font-medium';

                attribution.innerHTML = 'Photo by ';
                attribution.appendChild(photographerLink);
                attribution.innerHTML += ' on ';
                attribution.appendChild(unsplashLink);


                item.appendChild(img);
                item.appendChild(attribution);
                resultsGrid.appendChild(item);

                // IMPORTANT: Manually fire the download location event for compliance
                // This call should be made only when the user intends to "use" the photo (e.g., click to view full size or download), 
                // but for simplicity in this demo, we can log the requirement here.
                // console.log("Unsplash guideline reminder: When a photo is 'downloaded' or chosen for use, you MUST send a request to the download_location: " + photo.links.download_location);
            });
        }

        // --- EVENT LISTENERS ---
        searchButton.addEventListener('click', searchImages);
        
        // Allows searching by pressing Enter key
        searchInput.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') {
                searchImages();
            }
        });

        // Focus the input field on load for immediate typing
        window.onload = () => {
            searchInput.focus();
        };

    </script>
</body>
</html>
